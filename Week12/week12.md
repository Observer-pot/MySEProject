# Week12 软件工程实验报告

| 组员名单 | 黄梓轩   | 李嘉毅  | 梁恒中   |
| -------- | -------- | ------- | -------- |
| 学号     | 19335085 | 1335098 | 19335119 |

## 实验要求

- 完成系统该要设计说明书

# 系统概要设计说明书框架

## 1 引言

### 1.1 编写目的

本阶段已在系统的需求分析的基础上，对龙芯基础指令集架构模拟器作概要设计。主要解决了实现该系统需求的程序模块设计问题。包括如何把该系统划分成若干个模块，决定各个模块之间的接口，模块之间传递的信息，以及数据结构，模块结构的设计等。在以下的概要设计报告中将对在本阶段中对系统所做的所有概要设计进行详细的说明。

在下一阶段的详细设计中，程序设计员可参考此概要设计报告，在概要设计对龙芯基础指令集架构模拟器所做的模块结构设计的基础上，对模拟器进行详细设计。在以后的软件测试以及软件维护阶段也可以参考此说明书，以便了解在概要设计过程中所完成的各模块设计结构，或在修改时找出在本阶段设计的不足或者失误。

### 1.2 背景

本系统全名为'龙芯基础指令集模拟器LARS'，是由中山大学本科生三人黄梓轩、李嘉毅、梁恒中提出并开发，为能够熟练编写LA64/LA32汇编指令的编程人员，或正在学习LA64/LA32汇编指令的人员提供模拟器服务。

### 1.3 定义

专业术语：

- LARS：龙芯基础指令集模拟器

- LA64：64位龙芯指令集

- LA32：32位龙芯指令集

### 1.4参考资料

《龙芯架构参考手册 卷一：基础架构》--龙芯中科

## 2 总体设计

### 2.1 需求规定

本系统接收用户提供的LA64/LA32汇编指令，并将程序的运行结果提供给用户。

- 功能要求：

将LA64/LA32汇编指令编译为二进制码

完整的基于龙芯基础指令集架构的处理器执行流水线

执行LA64/LA32指令，并向用户展示执行结果

- 性能要求：

一百条指令完成时间小于1s

### 2.2 运行环境

不依赖其他库和特定IDE，可直接运行在java JDK上，要求JRE版本不低于1.7

### 2.3 基本设计概念和处理流程

基本设计概念如下，：

处理流程如下，用户先输入语句，然后用户界面将语句传输至编译器，编译器编译后将机器码传输至虚拟CPU，虚拟CPU执行完后将结果传回用户界面，由用户去查看结果：

### 2.4 结构

系统程序包含用户界面，编译器，命令，虚拟cpu等功能模块

### 2.5 功能需求与程序的关系

|      | UI模块 | 编译模块 | VCPU模块 |
| ---- | ------ | -------- | -------- |
| 输入 | √      |          |          |
| 编译 |        | √        |          |
| 运行 |        |          | √        |
| 展示 | √      |          |          |

### 2.6 人工处理过程

从用户交互界面输入汇编代码，与用户程序运行结果界面查看结果。

## 3 接口设计

### 3.1 用户接口

程序用户接口包括：
1. 用于编辑源程序的界面
2. 用于进行各种文件操作的菜单
3. 用于控制用户程序运行的菜单
4. 用于展示用户程序运行结果的界面

### 3.2 外部接口

暂无

### 3.3 内部接口

程序内部各个模块之间以函数调用、参数传递和函数返回值的方式传递数据。

## 4 运行设计

### 4.1 运行模块组合

程序分为3个模块：UI模块，编译模块和VCPU模块。UI模块始终在前台运行，编译模块和VCPU模块分别只在编译用户程序和运行用户程序时在后台活跃。

### 4.2 运行控制

程序启动后，由用户选择新建文档或打开已有文档。用户编辑完成后可以交由程序进行编译，程序向用户展示编译结果。用户可以选择运行编译得到的用户程序，程序向用户展示运行结果。

### 4.3 运行时间

不作硬性要求，具体运行时间取决于用户输入的源程序。

## 5 系统数据结构设计

### 5.1 逻辑结构设计要点

#### Instruction类

本程序设计了Instruction类来存储指令信息，其中存储了如下信息：

- length：指令长度
- context：指令内容
- bincode：指令的二进制编码
- tag：指令标签
- type：指令类别

#### DataMemory类

本程序设计了DataMemory类来存储数据信息，其中存储了如下信息：

- registers：存储了寄存器的值
- memory：存储了内存的值

### 5.2 物理结构设计要点

程序需要使用文件记录用户编写的源文件，文件类型为文本文件。

源文件中以字符串存储原始指令的语句，程序运行时指令采取顺序存储的模式，按顺序执行指令。

对于寄存器与内存中的值，以本程序数组模拟并展示。

### 5.3 数据结构与程序的关系

在UI中，指令

|             | UI   | Compiler | vCPU |
| ----------- | ---- | -------- | ---- |
| Instruction |      | √        | √    |
| DataMemory  |      |          | √    |

## 6 系统出错处理设计

### 6.1 出错信息

|错误类型|错误提示|
|-----|-----|
|未知指令|提示输入的指令无法识别，无法进行编译|
|指令使用错误|提示未正确使用指令，无法进行编译|
|立即数超出范围|提示输入的立即数超出可接受的范围，无法进行编译|
|内存访问越界|提示程序正在访问受限的内存区域，程序异常终止|

### 6.2 补救措施

当程序异常终止时，用户可以通过重启本程序并重新打开先前已保存的源文件恢复先前的工作状态。

### 6.3 系统维护设计

1. 程序中汇编助记符与机器码之间的映射关系不作硬编码，方便将来响应Loongarch指令集的变化。
2. ALU模块预留拓展接口，以便将来拓展操作类型。